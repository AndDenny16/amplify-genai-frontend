version: 1
frontend:
  phases:
    preBuild:
      commands:
        - nvm install 18    # Install Node.js version 18
        - nvm use 18        # Use Node.js version 18
        - npm ci
    build:
      commands:
        - NEXT_PUBLIC_DEFAULT_SYSTEM_PROMPT=${NEXT_PUBLIC_DEFAULT_SYSTEM_PROMPT}
        - OPENAI_API_KEY=${OPENAI_API_KEY}
        - OPENAI_API_HOST=${OPENAI_API_HOST}
        - OPENAI_API_TYPE=${OPENAI_API_TYPE}
        - OPENAI_API_VERSION=${OPENAI_API_VERSION}
        - AZURE_DEPLOYMENT_ID=${AZURE_DEPLOYMENT_ID}
        - AZURE_API_NAME=${AZURE_API_NAME}
        - AUTH0_AUDIENCE=${AUTH0_AUDIENCE}
        - AUTH0_SCOPE=${AUTH0_SCOPE}
        - STATE_API_URL=${STATE_API_URL}
        - SHARE_API_URL=${SHARE_API_URL}
        - AVAILABLE_MODELS=${AVAILABLE_MODELS}
        - DEFAULT_MODEL=${DEFAULT_MODEL}
        - AUTH0_SECRET=${AUTH0_SECRET}
        - AUTH0_BASE_URL=${AUTH0_BASE_URL}
        - AUTH0_ISSUER_BASE_URL=${AUTH0_ISSUER_BASE_URL}
        - AUTH0_CLIENT_ID=${AUTH0_CLIENT_ID}
        - AUTH0_CLIENT_SECRET=${AUTH0_CLIENT_SECRET}


        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*

